## TASK: Generate Q1 2026 Bookings Risk Analysis HTML Report

Working directory: /Users/prestonharris/Risk Report

### REQUIREMENTS

1. **Refactor `query_comprehensive_risk_analysis.sql`:**

   a) Add pipeline filter - only opportunities CREATED IN LAST 6 MONTHS:
   ```sql
   AND CreatedDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH)
   ```

   b) Add owner role filter - only AE or AM owned opportunities:
   - First discover the field: query OpportunityViewTable INFORMATION_SCHEMA for owner/role columns
   - Then filter by Owner_Role or similar field for 'Account Executive', 'Account Manager', 'AE', 'AM'

2. **Verify changes with BigQuery:**
   - Confirm pipeline date range is last 6 months only
   - Confirm owner roles are AE/AM only
   - Confirm Q1 totals still match (POR=$2,659,310, R360â‰ˆ$868,610)

3. **Generate HTML Report:**
   - Create a script (Node.js or Python) to run the query and generate HTML
   - Professional styling with RAG color coding (green/yellow/red)
   - Sections: Executive Summary, Product Performance, Top Risk Pockets, Funnel Pacing, Pipeline Analysis, Loss Analysis
   - Include note on Funnel Pacing: "MQL targets are INBOUND channel only"
   - Include note on Pipeline: "Filtered: Created last 6 months, AE/AM owned only"
   - Save to: /Users/prestonharris/Risk Report/reports/Q1_2026_Risk_Report_YYYY-MM-DD.html

4. **Make the HTML copy-paste friendly:**
   - Clean table formatting
   - Currency formatting ($XXX,XXX)
   - Percentage formatting with color coding
   - Self-contained (inline CSS, no external dependencies)

### KEY FILES

- Main query: query_comprehensive_risk_analysis.sql (v2.0.0, already has dynamic targets)
- Documentation: DATA_ISSUES_LOG.md, Q1_2026_TARGET_REFERENCE.md
- Full context: PROMPT_GENERATE_HTML_REPORT.md

### DATA QUALITY NOTES

- MQL targets are INBOUND-only (EMEA is outbound-heavy, APAC is inbound-heavy)
- PARTNERSHIPS targets are zeroed out per data quality fix
- Pipeline was previously including very old opps - new 6-month filter fixes this

### DELIVERABLES

1. Updated query_comprehensive_risk_analysis.sql with new filters
2. Report generation script (generate_html_report.py or .js)
3. Generated HTML report file

Begin by reading the current query, discovering the owner role field, then implementing the changes.
